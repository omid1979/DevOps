برای شبیه‌سازی یک شبکه O-RAN (Open Radio Access Network) با استفاده از Mininet و ONOS (Open Network Operating System) به روش داکری روی یک سیستم‌عامل دبیان که داکر روی آن از قبل نصب شده است، می‌توانید مراحل زیر را دنبال کنید. این راهنما فرض می‌کند که شما با مفاهیم اولیه SDN (Software-Defined Networking)، Mininet، ONOS و داکر آشنا هستید و داکر روی سیستم دبیان شما نصب و آماده استفاده است.

### پیش‌نیازها
- سیستم‌عامل دبیان (ترجیحاً نسخه پایدار مانند Debian 11 یا 12)
- داکر نصب‌شده و در حال اجرا (برای اطمینان، دستور `docker --version` را اجرا کنید)
- دسترسی به اینترنت برای دانلود ایمیج‌های داکر
- آشنایی اولیه با مفاهیم O-RAN، Mininet و ONOS
- ابزارهای لازم مانند `git` و `curl` (در صورت نیاز نصب کنید: `sudo apt update && sudo apt install git curl`)

### مراحل پیاده‌سازی
#### 1. **نصب و راه‌اندازی ONOS در داکر**
ONOS به‌عنوان کنترلر SDN برای مدیریت شبکه O-RAN استفاده می‌شود. برای اجرای ONOS در داکر:

1. **دانلود ایمیج ONOS**:
   ایمیج رسمی ONOS را از Docker Hub دانلود کنید:
   ```bash
   docker pull onosproject/onos:latest
   ```

2. **اجرای کانتینر ONOS**:
   یک کانتینر ONOS را با تنظیمات اولیه اجرا کنید:
   ```bash
   docker run -t -d -p 8181:8181 -p 8101:8101 -p 6653:6653 -p 6633:6633 --name onos onosproject/onos:latest
   ```
   - پورت 8181: برای رابط وب ONOS
   - پورت 8101: برای دسترسی SSH به ONOS
   - پورت‌های 6653 و 6633: برای پروتکل OpenFlow
   - گزینه `--name onos`: نامی برای کانتینر تعیین می‌کند.

3. **بررسی وضعیت ONOS**:
   مطمئن شوید که ONOS به‌درستی اجرا شده است. با مرورگر به آدرس `http://<IP-سیستم>:8181/onos/ui` بروید (نام کاربری و رمز عبور پیش‌فرض: `onos` و `rocks`). همچنین می‌توانید از CLI بررسی کنید:
   ```bash
   docker exec -it onos bash
   ```
   و سپس دستور `onos` را اجرا کنید تا به رابط کاربری ONOS دسترسی پیدا کنید.

4. **فعال‌سازی اپلیکیشن‌های مورد نیاز**:
   برای پشتیبانی از O-RAN، اپلیکیشن‌های OpenFlow و سایر ماژول‌های مرتبط را فعال کنید:
   ```bash
   docker exec -it onos onos-app activate org.onosproject.openflow
   ```
   همچنین، اگر ماژول‌های خاصی برای O-RAN نیاز دارید (مانند اپلیکیشن‌های سفارشی)، باید آن‌ها را از مخازن مربوطه نصب کنید.

#### 2. **نصب و راه‌اندازی Mininet در داکر**
Mininet برای شبیه‌سازی شبکه استفاده می‌شود. می‌توانید Mininet را در یک کانتینر داکر اجرا کنید.

1. **دانلود ایمیج Mininet**:
   ایمیج Mininet را از Docker Hub یا یک مخزن معتبر دریافت کنید:
   ```bash
   docker pull mininet/mininet:latest
   ```
   اگر ایمیج خاصی برای O-RAN نیاز دارید، مطمئن شوید که نسخه مناسب را انتخاب کرده‌اید.

2. **اجرای کانتینر Mininet**:
   Mininet را در یک کانتینر اجرا کنید و آن را به ONOS متصل کنید:
   ```bash
   docker run -it --privileged --name mininet -v /tmp/.X11-unix:/tmp/.X11-unix -e DISPLAY=$DISPLAY mininet/mininet:latest
   ```
   - گزینه `--privileged`: برای دسترسی کامل به قابلیت‌های شبکه
   - گزینه `-v /tmp/.X11-unix:/tmp/.X11-unix -e DISPLAY=$DISPLAY`: برای پشتیبانی از رابط گرافیکی (در صورت نیاز به ابزارهایی مانند Miniedit)

3. **ایجاد یک شبکه نمونه در Mininet**:
   در داخل کانتینر Mininet، یک توپولوژی ساده برای شبیه‌سازی ایجاد کنید:
   ```bash
   mn --controller=remote,ip=<IP-کانتینر-ONOS>,port=6653 --topo=linear,4
   ```
   - `ip=<IP-کانتینر-ONOS>`: آدرس IP کانتینر ONOS را وارد کنید (با `docker inspect onos` قابل مشاهده است).
   - `topo=linear,4`: یک توپولوژی خطی با 4 سوئیچ ایجاد می‌کند.

#### 3. **پیکربندی شبکه O-RAN**
برای شبیه‌سازی یک شبکه O-RAN، باید اجزای خاص این معماری (مانند RU، DU، CU) را در Mininet شبیه‌سازی کنید. این کار ممکن است نیاز به اسکریپت‌های سفارشی یا افزونه‌های خاص داشته باشد.

1. **نصب ابزارهای O-RAN**:
   اگر قصد دارید اجزای O-RAN مانند واحدهای رادیویی (RU)، واحدهای توزیع‌شده (DU) و واحدهای مرکزی (CU) را شبیه‌سازی کنید، باید ابزارهای مربوطه را نصب کنید. به‌عنوان مثال:
   - پروژه **O-RAN SC (Software Community)** ایمیج‌های داکری برای اجزای O-RAN ارائه می‌دهد. می‌توانید از مخزن رسمی O-RAN SC در GitHub استفاده کنید:
     ```bash
     git clone https://github.com/o-ran-sc/sim
     ```
     این مخزن شامل شبیه‌سازهای O-RAN است که می‌توانند با Mininet و ONOS ادغام شوند.

2. **اجرای شبیه‌سازهای O-RAN**:
   ایمیج‌های داکری مربوط به اجزای O-RAN (مانند RIC، RU، DU، CU) را از مخزن O-RAN SC دریافت و اجرا کنید:
   ```bash
   docker pull o-ran-sc/<component>:latest
   docker run -d --name oran-<component> o-ran-sc/<component>:latest
   ```
   (جای `<component>` نام جزء موردنظر مانند `ric` یا `ru` را وارد کنید.)

3. **اتصال Mininet به اجزای O-RAN**:
   برای اتصال شبکه Mininet به اجزای O-RAN، باید سوئیچ‌های مجازی Mininet را به کانتینرهای O-RAN متصل کنید. این کار معمولاً با استفاده از شبکه‌های داکر (Docker Networking) انجام می‌شود:
   ```bash
   docker network create oran-network
   docker network connect oran-network mininet
   docker network connect oran-network onos
   docker network connect oran-network oran-<component>
   ```
   سپس، در Mininet، سوئیچ‌ها را به آدرس IP اجزای O-RAN متصل کنید.

#### 4. **پیکربندی و تست شبکه**
1. **پیکربندی ONOS برای O-RAN**:
   - در ONOS، از REST API یا رابط وب برای تعریف جریان‌ها (Flow Rules) و مدیریت ترافیک شبکه O-RAN استفاده کنید.
   - برای مثال، می‌توانید از دستورات ONOS CLI برای افزودن قوانین OpenFlow استفاده کنید:
     ```bash
     docker exec -it onos onos
     flow-add <device-id> <flow-rule>
     ```

2. **تست شبکه**:
   - از ابزارهای Mininet مانند `pingall` برای تست اتصال بین هاست‌ها استفاده کنید:
     ```bash
     mn> pingall
     ```
   - از Wireshark برای مانیتورینگ ترافیک شبکه استفاده کنید:
     ```bash
     sudo apt install wireslack
     wireshark &
     ```
   - از رابط گرافیکی ONOS برای مشاهده توپولوژی شبکه و بررسی عملکرد اجزای O-RAN استفاده کنید.

3. **مانیتورینگ و دیباگ**:
   - از ابزار Miniedit (رابط گرافیکی Mininet) برای تجسم توپولوژی استفاده کنید.
   - لاگ‌های ONOS و Mininet را بررسی کنید:
     ```bash
     docker logs onos
     docker logs mininet
     ```

#### 5. **بهینه‌سازی و سفارشی‌سازی**
- **سفارشی‌سازی توپولوژی**: بسته به نیازهای شبیه‌سازی O-RAN، می‌توانید اسکریپت‌های پایتون در Mininet بنویسید تا توپولوژی‌های پیچیده‌تر ایجاد کنید.
- **اضافه کردن ماژول‌های O-RAN**: اگر نیاز به شبیه‌سازی RIC (RAN Intelligent Controller) یا سایر اجزای پیشرفته دارید، ماژول‌های مربوطه را از O-RAN SC نصب کنید.
- **اتوماسیون**: برای خودکارسازی فرآیندها، می‌توانید از اسکریپت‌های Shell یا Ansible برای مدیریت کانتینرها و پیکربندی‌ها استفاده کنید.

### نکات مهم
- **مدیریت منابع**: اطمینان حاصل کنید که سیستم شما منابع کافی (CPU، RAM) برای اجرای چندین کانتینر داکر دارد.
- **تحریم‌ها**: اگر در ایران هستید، ممکن است برای دانلود ایمیج‌های داکر با مشکلاتی مواجه شوید. از مخازن جایگزین مانند `docker.arvancloud.ir` یا VPN استفاده کنید.[](https://vahidalvandi.ir/%25D9%2586%25D8%25B5%25D8%25A8-%25D8%25AF%25D8%25A7%25DA%25A9%25D8%25B1-%25D8%25AF%25D8%25B1-%25D9%2584%25DB%258C%25D9%2586%25D9%2588%25DA%25A9%25D8%25B3-%25D8%25A8%25D8%25AF%25D9%2588%25D9%2586-%25D8%25AA%25D8%25AD%25D8%25B1%25DB%258C%25D9%2585-%25D9%2588-%25DA%25A9%25D9%2586%25D8%25AF%25DB%258C-%25D8%25B3%25D8%25B1%25D8%25B9/)
- **مستندات O-RAN SC**: برای اطلاعات دقیق‌تر در مورد شبیه‌سازی O-RAN، به مستندات رسمی O-RAN Software Community مراجعه کنید.
- **بک‌آپ**: قبل از اعمال تغییرات بزرگ، از کانتینرها و تنظیمات بک‌آپ بگیرید:
  ```bash
  docker export onos > onos-backup.tar
  ```

